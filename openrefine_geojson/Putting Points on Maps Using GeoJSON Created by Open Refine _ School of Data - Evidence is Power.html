<!DOCTYPE html>
<!-- saved from url=(0139)https://web.archive.org/web/20241007131606/https://schoolofdata.org/2014/05/19/putting-points-on-maps-using-geojson-created-by-open-refine/ -->
<html lang="en-US" style="--wm-toolbar-height: 67px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/athena.js" type="text/javascript"></script>
<script type="text/javascript" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/wombat.js" charset="utf-8"></script>
<script type="text/javascript" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/ruffle.js"></script>
<link rel="stylesheet" type="text/css" href="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

    
    <title>
      Putting Points on Maps Using GeoJSON Created by Open Refine | School of Data              - Evidence is Power          </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <meta name="description" content="Evidence is Power">
    
    <link rel="pingback" href="https://schoolofdata.org/xmlrpc.php">

        <script defer="" data-domain="schoolofdata.org" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/plausible.js"></script>
    <meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="https://web.archive.org/web/20241007131606/https://s.w.org/">
    
  </head>

<div class="container">

<div class="row">
  <div class="span8">
    <div class="padder">
      <div class="row">
        <div id="content" class="span8">

          <div class="page" id="blog-single" role="main">
                    <h2 class="posttitle">Putting Points on Maps Using GeoJSON Created by Open Refine</h2>
                                    
                    <div class="entry">
                      <p>Originally posted at <a href="https://schoolofdata.org/2014/05/19/putting-points-on-maps-using-geojson-created-by-open-refine/"> https://schoolofdata.org/2014/05/19/putting-points-on-maps-using-geojson-created-by-open-refine/</a> </p>
<p>Having access to geo-data is one thing, quickly sketching it on to a map is another. In this post, we look at how you can use <a href="https://web.archive.org/web/20241007131606/http://openrefine.org/">OpenRefine</a> to take some tabular data and export it in a format that can be quickly visualised on an interactive map.</p>
<p>At the School of Data, we try to promote an open standards based approach: if you put your data into a standard format, you can plug it directly into an application that someone else has built around that standard, confident in the knowledge that it should <em>“just work”</em>. That’s not always true of course, but we live in hope.</p>
<p>In the world of geo-data – geographical data – the <a href="https://web.archive.org/web/20241007131606/http://geojson.org/">geojson</a> standard defines a format that provides a relatively lightweight way of representing data associated with points (single markers on a map), lines (lines on a map) and polygons (shapes or regions on a map).</p>
<p>Many applications can read and write data in this format. In particular, Github’s <a href="https://web.archive.org/web/20241007131606/https://gist.github.com/"><em>gist</em> service</a> allows you to paste a geojson data file into a gist, whereupon it will render it for you (<a href="https://web.archive.org/web/20241007131606/https://github.com/blog/1576-gist-meets-geojson">Gist meets GeoJSON</a><a>).</a></p><a>
</a><p><a href="https://web.archive.org/web/20241007131606/https://www.flickr.com/photos/psychemedia/14010958000" title="Gists_and_test by Tony Hirst, on Flickr"><img src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14010958000_b2793869e7_z.jpg" width="640" height="385" alt="Gists_and_test"></a></p>
<p>So how can we get from some tabular data that looks something like this:</p>
<p><a href="https://web.archive.org/web/20241007131606/https://www.flickr.com/photos/psychemedia/14011159227" https://schoolofdata.org/2014/05/19/putting-points-on-maps-using-geojson-created-by-open-refine/simple_geo_points-tab_-_OpenRefine by Tony Hirst, on Flickr"><img loading="lazy" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14011159227_af2b6e237c_z.jpg" width="640" height="275" alt="simple_geo_points-tab_-_OpenRefine"></a></p>
<p>Into the geojson data, which looks something like this?</p>
<pre>{"features": [   {"geometry": 
        {   "coordinates": [  0.124862,
                 52.2033051
            ],
            "type": "Point"},
         "id": "Cambridge,UK",
         "properties": {}, "type": "Feature"
    },
   {"geometry": 
        {   "coordinates": [ 151.2164539,
                 -33.8548157
            ],
            "type": "Point"},
         "id": "Sydney, Australia",
         "properties": {}, "type": "Feature"
    }], "type": "FeatureCollection"}</pre>
<blockquote><p>[We’re assuming we have already <strong>geocoded</strong> the location to get latitude and longitude co-ordinates for it.</p></blockquote>
<p>One approach is to use OpenRefine [<a href="https://web.archive.org/web/20241007131606/http://openrefine.org/">openrefine.org</a>]. OpenRefine allows you to create your own custom export formats, so if we know what the geojson is supposed to look like (and the standard tells us that) we can create a template to export the data in that format.</p>
<h3> Steps to use Open Refine:</h3>
<p>Locate the template export tool is in the OpenRefine <em>Export</em> drop-down menu:</p>
<p><a href="https://web.archive.org/web/20241007131606/https://www.flickr.com/photos/psychemedia/14011526480" title="export-_OpenRefine by Tony Hirst, on Flickr"><img loading="lazy" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14011526480_ff52b2a592_n.jpg" width="320" height="311" alt="export-_OpenRefine"></a></p>
<p>Define the template for our templated export format. The way the template is applied is to create a standard header (the <em>prefix</em>), apply the template to each row, separating the templated output for each row by a specified delimiter, and then adding a standard footer (the <em>suffix</em>).</p>
<p><a href="https://web.archive.org/web/20241007131606/https://www.flickr.com/photos/psychemedia/14011089569" title="simple_geo_points_-_OpenRefine by Tony Hirst, on Flickr"><img loading="lazy" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14011089569_83869b79a3_z.jpg" width="640" height="380" alt="simple_geo_points_-_OpenRefine"></a></p>
<p>Once one person has worked out the template definition and shared it under an open license, the rest of us can copy it, reuse it, build on it, improve it, and if necessary, correct it…:-) The template definitions I’ve used here are a first attempt and represent a proof-of-concept demonstration: let us know if the approach looks like it could be useful and we can try to work it up some more.</p>
<p><em>It would be useful if OpenRefine supported the ability to save and import different template export configuration files, perhaps even allowing them to be imported from and save to a gist. Ideally, a menu selector would allow column names to be selected from the current data file and then used in template.</em></p>
<p>Here are the template settings for template that will take a column labelled “Place”, a column named “Lat” containing a numerical latitude value and a column named “Long” containing a numerical longitude and generate a geojson file that allows the points to be rendered on a map.</p>
<p><strong>Prefix:</strong></p>
<pre>{"features": [</pre>
<p><strong>Row template:</strong></p>
<pre> {"geometry": 
        {   "coordinates": [ {{cells["Long"].value}},
                {{cells["Lat"].value}}
            ],
            "type": "Point"},
         "id": {{jsonize(cells["Place"].value)}},
         "properties": {}, "type": "Feature"
    }</pre>
<p><strong>Row separator:</strong></p>
<pre>,</pre>
<p><strong>Suffix:</strong></p>
<pre>], "type": "FeatureCollection"}</pre>
<p>This template information is also available as a gist: <a href="https://web.archive.org/web/20241007131606/https://gist.github.com/psychemedia/53e30d3d151fea23af68">OpenRefine – geojson points export format template</a>.</p>
<p>Another type of data that we might want to render onto a map is a set of markers that are connected to each other by lines.</p>
<p>For example, here is some data that could be seen as describing connections between two places that are mentioned on the same data row:</p>
<p><a href="https://web.archive.org/web/20241007131606/https://www.flickr.com/photos/psychemedia/14011374838" title="point_to_point_demo_tab_-_OpenRefine by Tony Hirst, on Flickr"><img loading="lazy" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14011374838_b1ec0b2960_z.jpg" width="640" height="185" alt="point_to_point_demo_tab_-_OpenRefine"></a></p>
<p>The following template generates a place marker for each place name, and also a line feature that connects the two places.</p>
<p><strong>Prefix:</strong></p>
<pre>{"features": [</pre>
<p><strong>Row template:</strong></p>
<pre> {"geometry": 
        {   "coordinates": [ {{cells["from_lon"].value}},
                {{cells["from_lat"].value}}
            ],
            "type": "Point"},
         "id": {{jsonize(cells["from"].value)}},
         "properties": {}, "type": "Feature"
    },
{"geometry": 
        {   "coordinates": [ {{cells["to_lon"].value}},
                {{cells["to_lat"].value}}
            ],
            "type": "Point"},
         "id": {{jsonize(cells["to"].value)}},
         "properties": {}, "type": "Feature"
    },
{"geometry": {"coordinates": 
[[{{cells["from_lon"].value}}, {{cells["from_lat"].value}}], 
[{{cells["to_lon"].value}}, {{cells["to_lat"].value}}]], 
"type": "LineString"}, 
"id": null, "properties": {}, "type": "Feature"}</pre>
<p><strong>Row separator:</strong></p>
<pre>,</pre>
<p><strong>Suffix:</strong></p>
<pre>], "type": "FeatureCollection"}</pre>
<p>If we copy the geojson output from the preview window, we can paste it onto a gist to generate a map preview that way, or test it out in a geojson format checker such as <a href="https://web.archive.org/web/20241007131606/http://geojsonlint.com/">GeoJSONLint</a>:</p>
<p><a href="https://web.archive.org/web/20241007131606/http://geojsonlint.com/" title="GeoJSONLint_-_Validate_your_GeoJSON by Tony Hirst, on Flickr"><img loading="lazy" src="./Putting Points on Maps Using GeoJSON Created by Open Refine _ School of Data - Evidence is Power_files/14218169923_1110be12b9_z.jpg" width="640" height="310" alt="GeoJSONLint_-_Validate_your_GeoJSON"></a></p>
<p>I have pasted a copy of the OpenRefine template I used to generate the “lines connecting points” geojson here: <a href="https://web.archive.org/web/20241007131606/https://gist.github.com/psychemedia/0b330801a6a3535ba924">OpenRefine export template: connected places geojson</a>.</p>
<p>Finally, it’s worth noting that if we can define a standardised way of describing template generated outputs from tabular datasets, libraries can be written for other programming tools or languages, such as R or Python. These libraries could read in a template definition file (such as the gists based on the OpenRefine export template definitions that are linked to above) and then as a direct consequence support “table2format” export data format conversions.</p>
<p>Which makes me wonder: is there perhaps already a standard for defining custom templated export formats from a tabular data set?</p>
